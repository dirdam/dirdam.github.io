<!-- Copyright (c) Adrián Jiménez Pascual -  All rights reserved -->
<!-- This page and its content is protected under copyright and intellectual property laws.  -->
<!-- The content belongs to Adrián Jiménez Pascual, Tokio, Japan -->
<!-- All rights reserved. -->
<!--
  **  Lawbreakers will be reported to competent authorities and sentenced by the law   **
-->
<!--Copyright (c) Adrián Jiménez Pascual - http://www.ms.u-tokyo.ac.jp/~adri/ -->

<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<meta name="viewport" content="width=device-width, user-scalable=no">
<link rel="shortcut icon" href="../Lasso_logo.ico"/>

<title>Amarillo</title>

<script>
var Point = function(x, y) {
	this.x = x;
	this.y = y;
}
Point.prototype.draw = function(number) {
	context.fillStyle = "black";
	var radius = 3;
	context.beginPath();
	context.arc(this.x, this.y, radius, 0, 2*Math.PI);
	context.fill();
	context.font = radius*4 + "px Verdana";
	context.fillText(number, this.x - context.measureText(number).width/2, this.y + radius*6);
}

var menu = 0
var col1 = "rgb(200,200,0)"; var col2 = "gold";
onload = function() {
	var pass = prompt("Contraseña:");
	while (pass != "Andrés" && pass != "Andres") {
		pass = prompt("Contraseña incorrecta. Nuevo intento:");
	}
	//Canvas
	canvas = document.createElement("canvas");
	document.body.appendChild(canvas);
	canvas.style.position = "absolute"; canvas.style.left = 0; canvas.style.top = 0;
    canvas.width = innerWidth; canvas.height = innerHeight;
	context = canvas.getContext("2d");

	draw_background(col1);
}

var draw_background = function(col) {
	context.fillStyle = col;
	context.fillRect(0, 0, canvas.width, canvas.height);
}

var draw_buttons = function() {
	draw_background(col1)
	context.fillStyle = col2;
	context.fillRect(0, canvas.height*9/10, canvas.width, canvas.height/10);
	context.lineWidth = 10;
	// Left arrow
	context.strokeStyle = "black";
	context.beginPath();
	context.moveTo(canvas.width*1/6, canvas.height - canvas.height/20);
	context.lineTo(canvas.width*2/6, canvas.height - canvas.height/20);
	context.moveTo(canvas.width*5/24, canvas.height - canvas.height/20 - canvas.height/40);
	context.lineTo(canvas.width*1/6, canvas.height - canvas.height/20);
	context.lineTo(canvas.width*5/24, canvas.height - canvas.height/20 + canvas.height/40);
	// Right arrow
	context.moveTo(canvas.width - canvas.width*1/6, canvas.height - canvas.height/20);
	context.lineTo(canvas.width - canvas.width*2/6, canvas.height - canvas.height/20);
	context.moveTo(canvas.width - canvas.width*5/24, canvas.height - canvas.height/20 - canvas.height/40);
	context.lineTo(canvas.width - canvas.width*1/6, canvas.height - canvas.height/20);
	context.lineTo(canvas.width - canvas.width*5/24, canvas.height - canvas.height/20 + canvas.height/40);
	context.stroke();
	context.beginPath();
	context.lineWidth = 3;
	context.moveTo(0, canvas.height*9/10);
	context.lineTo(canvas.width, canvas.height*9/10);
	context.moveTo(canvas.width/2, canvas.height*9/10);
	context.lineTo(canvas.width/2, canvas.height);
	context.stroke();
	// Text
	context.fillStyle = "black";
	context.font = canvas.height/25 + "px Verdana";
	context.fillText("(" + menu + ")", canvas.width/2 - canvas.width/16 - context.measureText("(" + menu + ")").width/2, canvas.height - canvas.height/20 + canvas.height/100);
	context.fillText("(" + (texts.length - menu - 1) + ")", canvas.width/2 + canvas.width/16 - context.measureText("(" + (texts.length - menu - 1) + ")").width/2, canvas.height - canvas.height/20 + canvas.height/100);
}

var texts = [["¡Hola de nuevo!", "¡Ya te queda muy poco!"],
		["Presta mucha atención, porque te", "voy a explicar las instrucciones para", "el último juego."],
		["¿Ves este dibujo?", "El juego consiste en lo siguiente:"],
		["Elige un número. Por ejemplo, el 1."],
		["Empieza por el palo más cercano al 1,", "y comienza a descender, desviándote", "cada vez que puedas."],
		["Es decir, en este caso primero deberías", "bajar, luego te desvías a la derecha,", "luego bajas otra vez"],
		["y te vuelves a desviar.", " Como no hay más desvíos, el 1", "se ha transportado a la derecha."],
		["Si haces lo mismo con el 2", "éste es el camino que hace."],
		["Y el 3 hace así."],
		['Es decir,', '"1 2 3" se ha convertido en "2 3 1".'],
		["Si lo has entendido dale a continuar;", "si no, vuelve atrás y revisa el proceso.", "(Quedan 3 páginas de instrucciones)"],
		["¡Veo que lo has entendido!", "En la parte trasera del iPad hay un", "último papel escondido. Cógelo."],
		["Repite el juego que te acabo de", "explicar en el papel."],
		["Cuando acabes, da la vuelta al papel", "y lee lo que pone."]];
var draw_text = function() {
	draw_buttons();
	context.font = canvas.height/15 + "px Verdana";
	context.fillStyle = "black";
	for (var i = 0; i < texts[menu].length; i++) {
	    context.fillText(texts[menu][i], canvas.width/2 - context.measureText(texts[menu][i]).width/2, canvas.height*4/6 + (i < (texts[menu].length - 1)/2 ? -1 : 1)*Math.ceil(Math.abs(i - (texts[menu].length - 1)/2))*(canvas.height/6)/2);
	}
}

var draw_amidakuji = function() {
	if (menu < 5) {return}
	context.lineWidth = 7;
	context.strokeStyle = "red";
	context.beginPath();
	context.moveTo(canvas.width/3, canvas.height*0.7/6);
	context.lineTo(canvas.width/3, canvas.height*1.2/6);
	context.lineTo(canvas.width/3 + canvas.width/6, canvas.height*1.2/6);
	context.lineTo(canvas.width/3 + canvas.width/6, canvas.height*1.8/6);
	context.stroke();
	if (menu < 6) {return}
	context.lineTo(canvas.width/3 + canvas.width*2/6, canvas.height*1.8/6);
	context.lineTo(canvas.width/3 + canvas.width*2/6, canvas.height*2.3/6);
	context.stroke();
	context.fillStyle = "red";
	context.fillText("1", canvas.width/3 + canvas.width*2/6 - context.measureText("1").width/2, canvas.height*2.6/6);
	if (menu < 7) {return}
	context.lineWidth = 5;
	context.strokeStyle = "green";
	context.beginPath();
	context.moveTo(canvas.width/3 + canvas.width/6, canvas.height*0.7/6);
	context.lineTo(canvas.width/3 + canvas.width/6, canvas.height*1.2/6);
	context.lineTo(canvas.width/3, canvas.height*1.2/6);
	context.lineTo(canvas.width/3, canvas.height*2.3/6);
	context.stroke();
	context.fillStyle = "green";
	context.fillText("2", canvas.width/3 - context.measureText("2").width/2, canvas.height*2.6/6);
	if (menu < 8) {return}
	context.lineWidth = 3;
	context.strokeStyle = "blue";
	context.beginPath();
	context.moveTo(canvas.width/3 + canvas.width*2/6, canvas.height*0.7/6);
	context.lineTo(canvas.width/3 + canvas.width*2/6, canvas.height*1.8/6);
	context.lineTo(canvas.width/3 + canvas.width/6, canvas.height*1.8/6);
	context.lineTo(canvas.width/3 + canvas.width/6, canvas.height*2.3/6);
	context.stroke();
	context.fillStyle = "blue";
	context.fillText("3", canvas.width/3 + canvas.width/6 - context.measureText("3").width/2, canvas.height*2.6/6);	
	if (menu < 11) {return}
}

var draw_pattern = function() {
	context.lineWidth = 3;
	context.strokeStyle = "black";
	context.beginPath();
	// Vertical
	context.moveTo(canvas.width/3, canvas.height*0.7/6);
	context.lineTo(canvas.width/3, canvas.height*2.3/6);
	context.moveTo(canvas.width/3 + canvas.width/6, canvas.height*0.7/6);
	context.lineTo(canvas.width/3 + canvas.width/6, canvas.height*2.3/6);
	context.moveTo(canvas.width/3 + canvas.width*2/6, canvas.height*0.7/6);
	context.lineTo(canvas.width/3 + canvas.width*2/6, canvas.height*2.3/6);
	//Horizontal
	context.moveTo(canvas.width/3, canvas.height*1.2/6);
	context.lineTo(canvas.width/3 + canvas.width/6, canvas.height*1.2/6);
	context.moveTo(canvas.width/3 + canvas.width/6, canvas.height*1.8/6);
	context.lineTo(canvas.width/3 + canvas.width*2/6, canvas.height*1.8/6);
	context.stroke();
	// Text
	context.fillStyle = "black";
	context.font = canvas.height/20 + "px Verdana";
	context.beginPath();
	context.fillText("1", canvas.width/3 - context.measureText("1").width/2, canvas.height*0.6/6);
	context.fillText("2", canvas.width/3 + canvas.width/6 - context.measureText("1").width/2, canvas.height*0.6/6);
	context.fillText("3", canvas.width/3 + canvas.width*2/6 - context.measureText("1").width/2, canvas.height*0.6/6);
}

ontouchstart = function(event) {
	var x = event.touches[0].clientX;
	var y = event.touches[0].clientY;
	commonStart(x, y);
}

ontouchmove = function(event) {
	event.preventDefault();
}

onmousedown = function(event) {
	var x = event.clientX;
	var y = event.clientY;
	commonStart(x, y);
}

var order = 0;
var first = true;
function commonStart(x, y) {
	if (first) {
		draw_text();
		first = false;
	}
	else if (menu < texts.length){
		if (y > canvas.height*9/10) {
			if (x < canvas.width/2) {
				menu = Math.max(0, menu - 1);
			}
			else {
				menu = Math.min(texts.length - 1, menu + 1);
			}
			if (menu < texts.length) {
				draw_text();
				if (menu >= 2) {
					draw_pattern();
					draw_amidakuji();
				}
			}
		}
	}
}

function distance(x1, y1, x2, y2) {
	return Math.sqrt((x1 - x2)*(x1 - x2) + (y1 - y2)*(y1 - y2));
}
</script>